import"../chunks/DsnmJJEf.js";import{R as Ze,r as ut,P as Ae,v as Z,F as dt,w as ht,a8 as l,am as vt,K as ft,M as pt,O as Pe,Q as Re,D as be,aB as gt,aC as bt,A as De,T as wt,S as he,aD as Ue,ax as xt,aE as ze,aF as Je,i as yt,aG as ke,V as et,W as _t,aH as Se,aI as mt,aJ as Me,C as tt,aK as kt,aL as St,aM as Ot,aN as Ct,ap as Et,aO as rt,G as Tt,aP as At,aQ as Rt,t as Mt,e as Ft,Y as It,aR as Ht,a0 as x,a7 as g,an as ae,aS as qe,aT as we,_ as Kt,$ as Lt,u as Fe,a1 as K,ai as Ie,a9 as m,a3 as F,a5 as E,a6 as Vt,aa as b,a4 as j,ab as oe,az as Ye,aU as We,ay as Dt,aV as je,aA as He}from"../chunks/fKp2TFYF.js";import{i as P,b as zt}from"../chunks/C3iRxIYb.js";import{r as $t,s as Qe}from"../chunks/CyuLX6hW.js";function me(a,e){return e}function Nt(a,e,t){for(var s=a.items,r=[],i=e.length,c=0;c<i;c++)St(e[c].e,r,!0);var n=i>0&&r.length===0&&t!==null;if(n){var u=t.parentNode;Ot(u),u.append(t),s.clear(),G(a,e[0].prev,e[i-1].next)}Ct(r,()=>{for(var h=0;h<i;h++){var o=e[h];n||(s.delete(o.k),G(a,o.prev,o.next)),tt(o.e,!n)}})}function xe(a,e,t,s,r,i=null){var c=a,n={flags:e,items:new Map,first:null},u=(e&rt)!==0;if(u){var h=a;c=Z?Ae(dt(h)):h.appendChild(Ze())}Z&&ht();var o=null,O=!1,C=new Map,V=vt(()=>{var T=t();return yt(T)?T:T==null?[]:Je(T)}),f,y;function _(){Bt(y,f,n,C,c,r,e,s,t),i!==null&&(f.length===0?o?et(o):o=De(()=>i(c)):o!==null&&_t(o,()=>{o=null}))}ut(()=>{y??=Et,f=l(V);var T=f.length;if(O&&T===0)return;O=T===0;let M=!1;if(Z){var U=ft(c)===pt;U!==(T===0)&&(c=Pe(),Ae(c),Re(!1),M=!0)}if(Z){for(var Y=null,I,v=0;v<T;v++){if(be.nodeType===gt&&be.data===bt){c=be,M=!0,Re(!1);break}var w=f[v],H=s(w,v);I=$e(be,n,Y,null,w,H,v,r,e,t),n.items.set(H,I),Y=I}T>0&&Ae(Pe())}if(Z)T===0&&i&&(o=De(()=>i(c)));else if(wt()){var J=new Set,ee=he;for(v=0;v<T;v+=1){w=f[v],H=s(w,v);var te=n.items.get(H)??C.get(H);te?(e&(Se|ke))!==0&&st(te,w,v,e):(I=$e(null,n,null,null,w,H,v,r,e,t,!0),C.set(H,I)),J.add(H)}for(const[$,ie]of n.items)J.has($)||ee.skipped_effects.add(ie.e);ee.add_callback(_)}else _();M&&Re(!0),l(V)}),Z&&(c=be)}function Bt(a,e,t,s,r,i,c,n,u){var h=(c&At)!==0,o=(c&(Se|ke))!==0,O=e.length,C=t.items,V=t.first,f=V,y,_=null,T,M=[],U=[],Y,I,v,w;if(h)for(w=0;w<O;w+=1)Y=e[w],I=n(Y,w),v=C.get(I),v!==void 0&&(v.a?.measure(),(T??=new Set).add(v));for(w=0;w<O;w+=1){if(Y=e[w],I=n(Y,w),v=C.get(I),v===void 0){var H=s.get(I);if(H!==void 0){s.delete(I),C.set(I,H);var J=_?_.next:f;G(t,_,H),G(t,H,J),Ke(H,J,r),_=H}else{var ee=f?f.e.nodes_start:r;_=$e(ee,t,_,_===null?t.first:_.next,Y,I,w,i,c,u)}C.set(I,_),M=[],U=[],f=_.next;continue}if(o&&st(v,Y,w,c),(v.e.f&Me)!==0&&(et(v.e),h&&(v.a?.unfix(),(T??=new Set).delete(v))),v!==f){if(y!==void 0&&y.has(v)){if(M.length<U.length){var te=U[0],$;_=te.prev;var ie=M[0],ce=M[M.length-1];for($=0;$<M.length;$+=1)Ke(M[$],te,r);for($=0;$<U.length;$+=1)y.delete(U[$]);G(t,ie.prev,ce.next),G(t,_,ie),G(t,ce,te),f=te,_=ce,w-=1,M=[],U=[]}else y.delete(v),Ke(v,f,r),G(t,v.prev,v.next),G(t,v,_===null?t.first:_.next),G(t,_,v),_=v;continue}for(M=[],U=[];f!==null&&f.k!==I;)(f.e.f&Me)===0&&(y??=new Set).add(f),U.push(f),f=f.next;if(f===null)continue;v=f}M.push(v),_=v,f=v.next}if(f!==null||y!==void 0){for(var ne=y===void 0?[]:Je(y);f!==null;)(f.e.f&Me)===0&&ne.push(f),f=f.next;var ve=ne.length;if(ve>0){var Oe=(c&rt)!==0&&O===0?r:null;if(h){for(w=0;w<ve;w+=1)ne[w].a?.measure();for(w=0;w<ve;w+=1)ne[w].a?.fix()}Nt(t,ne,Oe)}}h&&Tt(()=>{if(T!==void 0)for(v of T)v.a?.apply()}),a.first=t.first&&t.first.e,a.last=_&&_.e;for(var Ce of s.values())tt(Ce.e);s.clear()}function st(a,e,t,s){(s&Se)!==0&&Ue(a.v,e),(s&ke)!==0?Ue(a.i,t):a.i=t}function $e(a,e,t,s,r,i,c,n,u,h,o){var O=(u&Se)!==0,C=(u&mt)===0,V=O?C?xt(r,!1,!1):ze(r):r,f=(u&ke)===0?c:ze(c),y={i:f,v:V,k:i,a:null,e:null,prev:t,next:s};try{if(a===null){var _=document.createDocumentFragment();_.append(a=Ze())}return y.e=De(()=>n(a,V,f,h),Z),y.e.prev=t&&t.e,y.e.next=s&&s.e,t===null?o||(e.first=y):(t.next=y,t.e.next=y.e),s!==null&&(s.prev=y,s.e.prev=y.e),y}finally{}}function Ke(a,e,t){for(var s=a.next?a.next.e.nodes_start:t,r=e?e.e.nodes_start:t,i=a.e.nodes_start;i!==null&&i!==s;){var c=kt(i);r.before(i),i=c}}function G(a,e,t){e===null?a.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Pt(a,e){return a==null?null:String(a)}function de(a,e,t,s){var r=a.__style;if(Z||r!==e){var i=Pt(e);(!Z||i!==a.getAttribute("style"))&&(i==null?a.removeAttribute("style"):a.style.cssText=i),a.__style=e}return s}function Ut(a,e,t=e){var s=new WeakSet;Rt(a,"input",async r=>{var i=r?a.defaultValue:a.value;if(i=Le(a)?Ve(i):i,t(i),he!==null&&s.add(he),await Mt(),i!==(i=e())){var c=a.selectionStart,n=a.selectionEnd,u=a.value.length;if(a.value=i??"",n!==null){var h=a.value.length;c===n&&n===u&&h>u?(a.selectionStart=h,a.selectionEnd=h):(a.selectionStart=c,a.selectionEnd=Math.min(n,h))}}}),(Z&&a.defaultValue!==a.value||Ft(e)==null&&a.value)&&(t(Le(a)?Ve(a.value):a.value),he!==null&&s.add(he)),It(()=>{var r=e();if(a===document.activeElement){var i=Ht??he;if(s.has(i))return}Le(a)&&r===Ve(a.value)||a.type==="date"&&!r&&!a.value||r!==a.value&&(a.value=r??"")})}function Le(a){var e=a.type;return e==="number"||e==="range"}function Ve(a){return a===""?null:+a}function Xe(a,e,t,s){if(!e)return{row:0,col:0};const{row:r,col:i}=e;switch(a.key){case"ArrowUp":return r>0?{row:r-1,col:i}:null;case"ArrowDown":return r<t-1?{row:r+1,col:i}:null;case"ArrowLeft":return i>0?{row:r,col:i-1}:null;case"ArrowRight":return i<s-1?{row:r,col:i+1}:null;default:return null}}function qt(a,e,t){return function(r){const i=r.target;if(!(i.tagName==="INPUT"||i.tagName==="TEXTAREA"||i.isContentEditable)){if(r.key==="Escape"){e.onEscape();return}if(r.metaKey||r.ctrlKey){const n=r.key.toLowerCase();if(n==="z"){r.preventDefault(),e.onUndo();return}if(n==="y"){r.preventDefault(),e.onRedo();return}if(n==="c"){r.preventDefault(),e.onCopy();return}if(n==="v"){r.preventDefault(),e.onPaste();return}}if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(r.key)){r.preventDefault();const{rows:n,cols:u}=t();if(r.shiftKey){const h=a.end.row!==-1?a.end:a.start,o=Xe(r,h,n,u);o&&(a.start.row===-1?a.startSelection(o.row,o.col):(a.end=o,a.updateOverlay()))}else{const h=a.getAnchor(),o=Xe(r,h,n,u);o&&a.moveTo(o.row,o.col)}}}}}class Yt{#e=x(!1);get visible(){return l(this.#e)}set visible(e){g(this.#e,e,!0)}#t=x(0);get x(){return l(this.#t)}set x(e){g(this.#t,e,!0)}#r=x(0);get y(){return l(this.#r)}set y(e){g(this.#r,e,!0)}#s=x(-1);get row(){return l(this.#s)}set row(e){g(this.#s,e,!0)}#a=x(-1);get col(){return l(this.#a)}set col(e){g(this.#a,e,!0)}open(e,t,s){e.preventDefault(),this.visible=!0,this.x=e.clientX,this.y=e.clientY,this.row=t,this.col=s}close(){this.visible=!1}}class Wt{#e=x(ae([]));get undoStack(){return l(this.#e)}set undoStack(e){g(this.#e,e,!0)}#t=x(ae([]));get redoStack(){return l(this.#t)}set redoStack(e){g(this.#t,e,!0)}record(e,t,s,r){s!==r&&(this.undoStack.push([{id:e,key:t,oldValue:s,newValue:r}]),this.redoStack=[])}recordBatch(e){e.length!==0&&(this.undoStack.push(e),this.redoStack=[])}undo(e){const t=this.undoStack.pop();if(t){for(let s=t.length-1;s>=0;s--){const r=t[s],i=e.find(c=>c.id===r.id);i&&(i[r.key]=r.oldValue)}this.redoStack.push(t)}}redo(e){const t=this.redoStack.pop();if(t){for(const s of t){const r=e.find(i=>i.id===s.id);r&&(r[s.key]=s.newValue)}this.undoStack.push(t)}}}class jt{#e=x("");get activeKey(){return l(this.#e)}set activeKey(e){g(this.#e,e,!0)}#t=x(!1);get filterOpen(){return l(this.#t)}set filterOpen(e){g(this.#t,e,!0)}#r=x(0);get x(){return l(this.#r)}set x(e){g(this.#r,e,!0)}#s=x(0);get y(){return l(this.#s)}set y(e){g(this.#s,e,!0)}toggle(e,t){if(e.stopPropagation(),this.activeKey===t){this.close();return}const r=e.currentTarget.getBoundingClientRect();this.activeKey=t,this.filterOpen=!1,this.y=r.bottom,this.x=r.left}toggleFilter(){this.filterOpen=!this.filterOpen}close(){this.activeKey="",this.filterOpen=!1}handleOutsideClick(e){this.activeKey===""||e.target.closest(".header-interactive")||this.close()}}class Qt{#e=x(ae({row:-1,col:-1}));get start(){return l(this.#e)}set start(e){g(this.#e,e,!0)}#t=x(ae({row:-1,col:-1}));get end(){return l(this.#t)}set end(e){g(this.#t,e,!0)}#r=x(!1);get isSelecting(){return l(this.#r)}set isSelecting(e){g(this.#r,e,!0)}#s=x(ae({top:0,left:0,width:0,height:0,visible:!1}));get selectionOverlay(){return l(this.#s)}set selectionOverlay(e){g(this.#s,e,!0)}#a=x(ae({top:0,left:0,width:0,height:0,visible:!1}));get copyOverlay(){return l(this.#a)}set copyOverlay(e){g(this.#a,e,!0)}calculateOverlayRect(e,t){if(e.row===-1||t.row===-1)return{top:0,left:0,width:0,height:0,visible:!1};const s=Math.min(e.row,t.row),r=Math.max(e.row,t.row),i=Math.min(e.col,t.col),c=Math.max(e.col,t.col),n=document.querySelector(`div[data-row="${s}"][data-col="${i}"]`),u=document.querySelector(`div[data-row="${r}"][data-col="${c}"]`);return!n||!u?{top:0,left:0,width:0,height:0,visible:!1}:{top:n.offsetTop,left:n.offsetLeft,width:u.offsetLeft+u.offsetWidth-n.offsetLeft,height:u.offsetTop+u.offsetHeight-n.offsetTop,visible:!0}}updateOverlay(){this.selectionOverlay=this.calculateOverlayRect(this.start,this.end)}startSelection(e,t){if(this.start.row===e&&this.start.col===t&&this.end.row===e&&this.end.col===t){this.reset(),this.isSelecting=!1;return}this.isSelecting=!0,this.start={row:e,col:t},this.end={row:e,col:t},this.updateOverlay()}extendSelection(e,t){this.isSelecting&&(this.end={row:e,col:t},this.updateOverlay())}endSelection(){this.isSelecting=!1}moveTo(e,t){this.start={row:e,col:t},this.end={row:e,col:t},this.updateOverlay()}selectCell(e,t){this.start={row:e,col:t},this.end={row:e,col:t},this.updateOverlay()}snapshotAsCopied(){const e=this.calculateOverlayRect(this.start,this.end);e.visible&&(this.copyOverlay=e)}clearCopyOverlay(){this.copyOverlay={top:0,left:0,width:0,height:0,visible:!1}}reset(){this.start={row:-1,col:-1},this.end={row:-1,col:-1},this.selectionOverlay.visible=!1}resetAll(){this.reset(),this.copyOverlay.visible=!1}getBounds(){return this.start.row===-1||this.end.row===-1?null:{minRow:Math.min(this.start.row,this.end.row),maxRow:Math.max(this.start.row,this.end.row),minCol:Math.min(this.start.col,this.end.col),maxCol:Math.max(this.start.col,this.end.col)}}isCellInCopyOverlay(e,t){if(!this.copyOverlay.visible)return!1;const s=document.querySelector(`div[data-row="${e}"][data-col="${t}"]`);if(!s)return!1;const r=s.offsetTop,i=s.offsetLeft,c=i+s.offsetWidth,n=r+s.offsetHeight,u=this.copyOverlay.top,h=this.copyOverlay.left,o=h+this.copyOverlay.width,O=u+this.copyOverlay.height;return i>=h&&c<=o&&r>=u&&n<=O}selectionMatchesCopy(){return!this.selectionOverlay.visible||!this.copyOverlay.visible?!1:this.selectionOverlay.top===this.copyOverlay.top&&this.selectionOverlay.left===this.copyOverlay.left&&this.selectionOverlay.width===this.copyOverlay.width&&this.selectionOverlay.height===this.copyOverlay.height}hasSelection(){return this.start.row!==-1&&this.end.row!==-1}getAnchor(){return this.start.row!==-1?this.start:null}}async function Xt(a){try{await navigator.clipboard.writeText(a)}catch(e){console.error("Failed to copy to clipboard:",e)}}async function Gt(){try{return await navigator.clipboard.readText()}catch(a){return console.error("Failed to read from clipboard:",a),null}}class Zt{#e=x(ae([]));get internal(){return l(this.#e)}set internal(e){g(this.#e,e,!0)}lastCopiedText="";async copy(e,t,s){e.snapshotAsCopied();const r=e.getBounds();if(!r)return;const i=[],c=[];for(let u=r.minRow;u<=r.maxRow;u++){const h=[];for(let o=r.minCol;o<=r.maxCol;o++){const O=s[o],C=String(t[u][O]??"");i.push({relRow:u-r.minRow,relCol:o-r.minCol,value:C}),h.push(C)}c.push(h.join("	"))}this.internal=i;const n=c.join(`
`);this.lastCopiedText=n,setTimeout(async()=>{await Xt(n)},0)}async paste(e,t,s,r){if(!e)return null;const i=await Gt();if(i===null)return null;const c=this.internal.length>0&&i===this.lastCopiedText,n=[];let u=0,h=0;if(c)for(const o of this.internal){const O=e.row+o.relRow,C=e.col+o.relCol;o.relRow>u&&(u=o.relRow),o.relCol>h&&(h=o.relCol);const V=this.applyValue(O,C,o.value,t,s);V&&n.push(V)}else i.split(/\r?\n/).forEach((O,C)=>{if(!O)return;C>u&&(u=C),O.split("	").forEach((f,y)=>{y>h&&(h=y);const _=e.row+C,T=e.col+y,M=this.applyValue(_,T,f,t,s);M&&n.push(M)})});return n.length>0&&(r.recordBatch(n),console.log(`Pasted ${n.length} cells.`)),{rows:u+1,cols:h+1}}applyValue(e,t,s,r,i){if(e>=0&&e<r.length&&t>=0&&t<i.length){const c=r[e],n=i[t],u=String(c[n]??"");if(u!==s)return c[n]=s,{id:c.id,key:n,oldValue:u,newValue:s}}return null}clear(){this.internal=[],this.lastCopiedText=""}hasData(){return this.internal.length>0}}class Jt extends Map{#e=new Map;#t=x(0);#r=x(0);#s=qe||-1;constructor(e){if(super(),e){for(var[t,s]of e)super.set(t,s);this.#r.v=super.size}}#a(e){return qe===this.#s?x(e):ze(e)}has(e){var t=this.#e,s=t.get(e);if(s===void 0){var r=super.get(e);if(r!==void 0)s=this.#a(0),t.set(e,s);else return l(this.#t),!1}return l(s),!0}forEach(e,t){this.#i(),super.forEach(e,t)}get(e){var t=this.#e,s=t.get(e);if(s===void 0){var r=super.get(e);if(r!==void 0)s=this.#a(0),t.set(e,s);else{l(this.#t);return}}return l(s),super.get(e)}set(e,t){var s=this.#e,r=s.get(e),i=super.get(e),c=super.set(e,t),n=this.#t;if(r===void 0)r=this.#a(0),s.set(e,r),g(this.#r,super.size),we(n);else if(i!==t){we(r);var u=n.reactions===null?null:new Set(n.reactions),h=u===null||!r.reactions?.every(o=>u.has(o));h&&we(n)}return c}delete(e){var t=this.#e,s=t.get(e),r=super.delete(e);return s!==void 0&&(t.delete(e),g(this.#r,super.size),g(s,-1),we(this.#t)),r}clear(){if(super.size!==0){super.clear();var e=this.#e;g(this.#r,0);for(var t of e.values())g(t,-1);we(this.#t),e.clear()}}#i(){l(this.#t);var e=this.#e;if(this.#r.v!==e.size){for(var t of super.keys())if(!e.has(t)){var s=this.#a(0);e.set(t,s)}}for([,s]of this.#e)l(s)}keys(){return l(this.#t),super.keys()}values(){return this.#i(),super.values()}entries(){return this.#i(),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return l(this.#r),super.size}}function er(a,e){const t=a.map(s=>s[e]).filter(s=>s!=null&&s!=="");return[...new Set(t)].sort().map(String)}function tr(a,e,t){return a.some(r=>r.key===e&&r.value===t)?a.filter(r=>!(r.key===e&&r.value===t)):[...a,{key:e,value:t}]}function rr(a,e){return a.filter(t=>t!==e)}class sr{#e=x("");get term(){return l(this.#e)}set term(e){g(this.#e,e,!0)}#t=x("");get inputValue(){return l(this.#t)}set inputValue(e){g(this.#t,e,!0)}#r=x(ae([]));get selectedFilters(){return l(this.#r)}set selectedFilters(e){g(this.#r,e,!0)}filterOptions=new Jt;#s=x("");get error(){return l(this.#s)}set error(e){g(this.#s,e,!0)}async search(e){try{const t=new URLSearchParams;if(this.term&&t.set("q",this.term),this.selectedFilters.length>0&&this.selectedFilters.forEach(i=>{t.append("filter",`${i.key}:${i.value}`)}),!this.term&&this.selectedFilters.length===0)return this.error="",[...e];const s=await fetch(`./api/search?${t.toString()}`);if(!s.ok){const i=await s.json();throw new Error(i.message||"Failed to fetch assets")}const r=await s.json();return this.error="",r.assets}catch(t){return this.error=t instanceof Error?t.message:"An unknown error occurred.",console.error("Database query failed:",this.error),[]}}executeSearch(){this.term=this.inputValue}clearSearch(){this.term="",this.inputValue=""}getFilterItems(e,t){return this.filterOptions.size>0&&this.filterOptions.has(e)?this.filterOptions.get(e):er(t,e)}selectFilterItem(e,t,s){this.selectedFilters=tr(this.selectedFilters,t,e),this.filterOptions.has(t)||this.filterOptions.set(t,this.getFilterItems(t,s))}removeFilter(e){this.selectedFilters=rr(this.selectedFilters,e)}clearAllFilters(){this.selectedFilters=[]}cleanupFilterCache(){const e=new Set(this.selectedFilters.map(t=>t.key));for(const t of this.filterOptions.keys())e.has(t)||this.filterOptions.delete(t)}isFilterSelected(e,t){return this.selectedFilters.some(s=>s.key===e&&s.value===t)}getFilterCount(){return this.selectedFilters.length}}function Ge(a,e,t){const s=t==="asc"?1:-1;return[...a].sort((r,i)=>{const c=r[e],n=i[e];return c==null?1:n==null?-1:typeof c=="number"&&typeof n=="number"?(c-n)*s:String(c).localeCompare(String(n))*s})}class ar{#e=x("");get key(){return l(this.#e)}set key(e){g(this.#e,e,!0)}#t=x("asc");get direction(){return l(this.#t)}set direction(e){g(this.#t,e,!0)}cache=new Map;originalOrder=[];getCacheKey(){return`${this.key}-${this.direction}`}update(e,t){this.key===e&&this.direction===t?(this.key="id",this.direction="asc"):(this.key=e,this.direction=t)}reset(){this.key="",this.direction="asc",this.cache.clear(),this.originalOrder=[]}async applyAsync(e){if((this.originalOrder.length===0||this.originalOrder!==e)&&(this.originalOrder=e,this.cache.clear()),!this.key)return e;const t=this.getCacheKey();if(this.cache.has(t))return this.cache.get(t);const s=await new Promise(r=>{setTimeout(()=>{const i=Ge(e,this.key,this.direction);r(i)},0)});return this.cache.set(t,s),s}apply(e){if(!this.key)return e;const t=this.getCacheKey();if(this.cache.has(t))return this.cache.get(t);const s=Ge(e,this.key,this.direction);return this.cache.set(t,s),s}invalidateCache(){this.cache.clear(),this.originalOrder=[]}}class ir{rowHeight=32;overscan=15;#e=x(0);get scrollTop(){return l(this.#e)}set scrollTop(e){g(this.#e,e,!0)}#t=x(0);get containerHeight(){return l(this.#t)}set containerHeight(e){g(this.#t,e,!0)}get visibleRange(){const e=Math.max(0,Math.floor(this.scrollTop/this.rowHeight)-this.overscan),t=Math.ceil(this.containerHeight/this.rowHeight),s=e+t+this.overscan*2;return{startIndex:e,endIndex:s}}getVisibleItems(e){const{startIndex:t,endIndex:s}=this.visibleRange,r=Math.min(s,e.length);return{items:e.slice(t,r),startIndex:t,endIndex:r}}getTotalHeight(e){return e*this.rowHeight}getOffsetY(){return this.visibleRange.startIndex*this.rowHeight}handleScroll(e){const t=e.target;this.scrollTop=t.scrollTop}updateContainerHeight(e){this.containerHeight=e}scrollToRow(e,t){if(!t)return;const s=e*this.rowHeight;t.scrollTop=s,this.scrollTop=s}getActualIndex(e){return this.visibleRange.startIndex+e}isRowVisible(e){const{startIndex:t,endIndex:s}=this.visibleRange;return e>=t&&e<s}}function nr(a,e){e.close()}var lr=K('<div class="p-1 border rounded-md border-neutral-700 dark:border-neutral-300 space-x-2 flex items-center"><span class="cursor-default"> </span> <button class="text-neutral-500 dark:text-neutral-300 text-base hover:dark:text-red-400 hover:text-red-600 hover:cursor-pointer">✕</button></div>'),or=K('<span class="text-xs text-neutral-500 dark:text-neutral-400 animate-pulse">Sorting...</span>'),cr=K('<button class="cursor-pointer bg-red-600 hover:bg-red-700 px-2 py-1 text-neutral-100">Clear</button>'),ur=(a,e,t)=>e.toggle(a,l(t)),dr=K("<span> </span>"),hr=K('<span class="invisible group-hover:visible text-neutral-400">▾</span>'),vr=K('<div class="header-interactive relative group border-r border-neutral-200 dark:border-slate-600 last:border-r-0" style="width: 150px; min-width: 150px;"><button class="w-full h-full px-2 py-2 text-xs font-medium text-neutral-900 dark:text-neutral-100 uppercase hover:bg-neutral-100 dark:hover:bg-slate-600 text-left flex items-center justify-between focus:outline-none focus:bg-neutral-200 dark:focus:bg-slate-500 cursor-pointer"><span class="truncate"> </span> <span class="ml-1"><!></span></button></div>'),fr=K('<div class="absolute pointer-events-none z-20 border-2 border-dotted border-blue-600 dark:border-blue-500"></div>'),pr=K('<div class="absolute pointer-events-none z-10 border-2 border-blue-600 dark:border-blue-500 bg-blue-100/10 dark:bg-blue-500/10"></div>'),gr=K(`<div class="
                  h-8 px-2 flex items-center text-xs whitespace-nowrap overflow-hidden text-ellipsis cursor-cell
                  text-neutral-700 dark:text-neutral-200 
                  hover:bg-blue-100 dark:hover:bg-slate-600
                  border-r border-neutral-200 dark:border-slate-700 last:border-r-0
                " style="width: 150px; min-width: 150px;"> </div>`),br=K('<div class="flex border-b border-neutral-200 dark:border-slate-700 hover:bg-blue-50 dark:hover:bg-slate-700 transition-colors"></div>'),wr=K('<div class="rounded-lg border border-neutral-200 dark:border-slate-700 bg-white dark:bg-slate-800 overflow-auto h-[calc(100dvh-9.3rem)] shadow-md relative select-none"><div class="w-max min-w-full bg-white dark:bg-slate-800 text-left relative"><div class="sticky top-0 z-20 flex border-b border-neutral-200 dark:border-slate-600 bg-neutral-50 dark:bg-slate-700"></div> <div class="absolute w-full"><!> <!> <!></div></div></div> <p class="mt-2 ml-1 text-sm text-neutral-600 dark:text-neutral-300"> </p>',1),xr=K('<p class="text-red-500"> </p>'),yr=K("<p>Query successful, but no data was returned.</p>"),_r=a=>a.stopPropagation(),mr=(a,e,t)=>e(t.activeKey,"asc"),kr=(a,e,t)=>e(t.activeKey,"desc"),Sr=(a,e)=>e.toggleFilter(),Or=K('<button class="px-3 py-1.5 hover:bg-blue-50 dark:hover:bg-slate-700 text-left flex items-center gap-2 group w-full"><div class="w-4 flex justify-center text-blue-600 dark:text-blue-400 font-bold"><!></div> <div class="truncate"> </div></button>'),Cr=K('<div class="px-3 py-1.5 text-neutral-500">No items found.</div>'),Er=K('<div class="absolute z-50 top-0 left-full ml-1 bg-white dark:bg-slate-800 border border-neutral-300 dark:border-slate-700 rounded shadow-xl py-1 text-sm min-w-48"><div class="max-h-48 overflow-y-auto no-scrollbar"></div></div>'),Tr=K('<div class="fixed z-50 bg-white dark:bg-slate-800 border border-neutral-300 dark:border-slate-700 rounded shadow-xl py-1 text-sm text-neutral-900 dark:text-neutral-100 min-w-48 font-normal normal-case cursor-default text-left flex flex-col"><button class="px-3 py-1.5 hover:bg-blue-50 dark:hover:bg-slate-700 text-left flex items-center gap-2 group w-full"><div class="w-4 flex justify-center text-blue-600 dark:text-blue-400 font-bold"><!></div> <span>Sort A to Z</span></button> <button class="px-3 py-1.5 hover:bg-blue-50 dark:hover:bg-slate-700 text-left flex items-center gap-2 group w-full"><div class="w-4 flex justify-center text-blue-600 dark:text-blue-400 font-bold"><!></div> <span>Sort Z to A</span></button> <div class="border-b border-neutral-200 dark:border-slate-700 my-1"></div> <div class="relative w-full"><button class="px-3 py-1.5 hover:bg-blue-50 dark:hover:bg-slate-700 text-left flex items-center justify-between group w-full"><div class="flex items-center gap-2"><div class="w-4"></div> <span>Filter By</span></div> <span class="text-neutral-400 group-hover:text-blue-600 dark:group-hover:text-blue-400">›</span></button> <!></div></div>'),Ar=a=>a.stopPropagation(),Rr=K(`<div class="fixed z-[60] bg-white dark:bg-slate-800 border border-neutral-300 dark:border-slate-700 rounded shadow-xl py-1 text-sm text-neutral-900 dark:text-neutral-100 min-w-32 cursor-default text-left flex flex-col"><button class="px-3 py-1.5 hover:bg-blue-50 dark:hover:bg-slate-700 text-left flex items-center gap-2 group"><svg class="w-4 h-4 text-neutral-500 dark:text-neutral-400 group-hover:text-blue-600 dark:group-hover:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg> <span>Edit</span></button> <div class="border-b border-neutral-200 dark:border-slate-700 my-1"></div> <button class="px-3 py-1.5 hover:bg-blue-50 dark:hover:bg-slate-700 text-left flex items-center gap-2 group"><svg class="w-4 h-4 text-neutral-500 dark:text-neutral-400 
        group-hover:text-blue-600 dark:group-hover:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg> <span>Copy</span></button> <button class="px-3 py-1.5 hover:bg-blue-50 dark:hover:bg-slate-700 text-left flex items-center gap-2 group"><svg class="w-4 h-4 text-neutral-500 dark:text-neutral-400 group-hover:text-blue-600 dark:group-hover:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 
        0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg> <span>Paste</span></button></div>`),Mr=K('<div class="flex flex-row gap-4 items-center mb-2"><h2 class="text-lg font-bold whitespace-nowrap">Asset Master</h2> <div class="flex gap-4 items-center"><input class="bg-white dark:bg-neutral-100 dark:text-neutral-700 p-1 border border-neutral-300 dark:border-none focus:outline-none" placeholder="Search this list..."/> <button class="cursor-pointer bg-blue-500 hover:bg-blue-600 px-2 py-1 text-neutral-100">Search</button></div> <div class="flex flex-row w-full justify-between items-center"><div class="flex flex-row text-xs gap-2"></div> <div class="flex gap-2 items-center"><!> <!></div></div></div> <!> <!> <!>',1);function Lr(a,e){Lt(e,!0);const t=new Yt,s=new Wt,r=new jt,i=new Qt,c=new Zt,n=new sr,u=new ar,h=new ir;let o=x(ae(e.data.assets)),O=e.data.assets.length>0?Object.keys(e.data.assets[0]):[],C=x(null),V=x(!1);const f=Ye(()=>h.getVisibleItems(l(o))),y=qt(i,{onCopy:M,onPaste:I,onUndo:()=>s.undo(l(o)),onRedo:()=>s.redo(l(o)),onEscape:()=>{i.resetAll(),c.clear(),t.visible&&t.close()}},()=>({rows:l(o).length,cols:O.length}));async function _(){const d=await n.search(e.data.assets);g(o,d,!0),i.reset(),u.invalidateCache(),u.reset()}async function T(d,p){g(V,!0),u.update(d,p),g(o,await u.applyAsync(l(o)),!0),g(V,!1),r.close()}async function M(){await c.copy(i,l(o),O),t.visible&&t.close()}function U(d,p,k){const A=h.getActualIndex(p);i.selectCell(A,k),t.open(d,A,k)}function Y(){return t.visible?{row:t.row,col:t.col}:i.getAnchor()}async function I(){const d=Y();if(!d)return;const p=await c.paste(d,l(o),O,s);if(t.visible&&t.close(),p){const k=d.row,A=d.col,N=Math.min(k+p.rows-1,l(o).length-1),L=Math.min(A+p.cols-1,O.length-1);i.reset(),i.startSelection(k,A),i.extendSelection(N,L),i.endSelection()}}function v(d){t.visible&&t.close(),r.handleOutsideClick(d)}Fe(()=>{if(window.addEventListener("click",v),window.addEventListener("keydown",y),window.addEventListener("mouseup",()=>i.endSelection()),l(C)){const d=new ResizeObserver(p=>{for(const k of p)h.updateContainerHeight(k.contentRect.height)});return d.observe(l(C)),()=>{window.removeEventListener("click",v),window.removeEventListener("keydown",y),window.removeEventListener("mouseup",()=>i.endSelection()),d.disconnect()}}return()=>{window.removeEventListener("click",v),window.removeEventListener("keydown",y),window.removeEventListener("mouseup",()=>i.endSelection())}}),Fe(()=>{n.term,n.selectedFilters,_()}),Fe(()=>{l(o),n.cleanupFilterCache()});var w=Mr(),H=Ie(w),J=F(m(H),2),ee=m(J);$t(ee),ee.__keydown=d=>{d.key==="Enter"&&n.executeSearch()};var te=F(ee,2);te.__click=()=>n.executeSearch(),b(J);var $=F(J,2),ie=m($);xe(ie,21,()=>n.selectedFilters,me,(d,p)=>{var k=lr(),A=m(k),N=m(A);b(A);var L=F(A,2);L.__click=()=>n.removeFilter(l(p)),b(k),j(D=>oe(N,`${D??""}: ${l(p).value??""}`),[()=>(l(p).key.charAt(0).toUpperCase()+l(p).key.slice(1)).replaceAll("_"," ")]),E(d,k)}),b(ie);var ce=F(ie,2),ne=m(ce);{var ve=d=>{var p=or();E(d,p)};P(ne,d=>{l(V)&&d(ve)})}var Oe=F(ne,2);{var Ce=d=>{var p=cr();p.__click=()=>n.clearAllFilters(),E(d,p)};P(Oe,d=>{n.getFilterCount()>0&&d(Ce)})}b(ce),b($),b(H);var Ne=F(H,2);{var at=d=>{var p=wr(),k=Ie(p),A=m(k),N=m(A);xe(N,21,()=>O,me,(R,S)=>{var z=vr(),Q=m(z);Q.__click=[ur,r,S];var W=m(Q),re=m(W,!0);b(W);var se=F(W,2),X=m(se);{var q=B=>{var le=dr(),ge=m(le,!0);b(le),j(()=>oe(ge,u.direction==="asc"?"▲":"▼")),E(B,le)},pe=B=>{var le=hr();E(B,le)};P(X,B=>{u.key===l(S)?B(q):B(pe,!1)})}b(se),b(Q),b(z),j(B=>oe(re,B),[()=>l(S).replaceAll("_"," ")]),E(R,z)}),b(N);var L=F(N,2),D=m(L);{var ue=R=>{var S=fr();j(()=>de(S,`
                top: ${i.copyOverlay.top??""}px;
                left: ${i.copyOverlay.left??""}px; 
                width: ${i.copyOverlay.width??""}px; 
                height: ${i.copyOverlay.height??""}px;
            `)),E(R,S)};P(D,R=>{i.copyOverlay.visible&&R(ue)})}var ye=F(D,2);{var Ee=R=>{var S=pr();j(()=>de(S,`
                top: ${i.selectionOverlay.top??""}px;
                left: ${i.selectionOverlay.left??""}px; 
                width: ${i.selectionOverlay.width??""}px; 
                height: ${i.selectionOverlay.height??""}px;
            `)),E(R,S)};P(ye,R=>{i.selectionOverlay.visible&&!i.selectionMatchesCopy()&&R(Ee)})}var _e=F(ye,2);xe(_e,19,()=>l(f).items,(R,S)=>R.id||l(f).startIndex+S,(R,S,z)=>{const Q=Ye(()=>l(f).startIndex+l(z));var W=br();xe(W,21,()=>O,me,(re,se,X)=>{var q=gr();Qe(q,"data-col",X),q.__mousedown=()=>i.startSelection(l(Q),X),q.__contextmenu=B=>U(B,l(z),X);var pe=m(q,!0);b(q),j(()=>{Qe(q,"data-row",l(Q)),oe(pe,l(S)[l(se)])}),We("mouseenter",q,()=>i.extendSelection(l(Q),X)),E(re,q)}),b(W),E(R,W)}),b(L),b(A),b(k),zt(k,R=>g(C,R),()=>l(C));var fe=F(k,2),Te=m(fe);b(fe),j((R,S)=>{de(A,`height: ${R??""}px;`),de(L,`transform: translateY(${S??""}px);`),oe(Te,`Showing ${l(o).length??""} items.`)},[()=>h.getTotalHeight(l(o).length),()=>h.getOffsetY()]),We("scroll",k,R=>h.handleScroll(R)),E(d,p)},it=d=>{var p=Dt(),k=Ie(p);{var A=L=>{var D=xr(),ue=m(D);b(D),j(()=>oe(ue,`Error: ${n.error??""}`)),E(L,D)},N=L=>{var D=yr();E(L,D)};P(k,L=>{n.error?L(A):L(N,!1)},!0)}E(d,p)};P(Ne,d=>{l(o).length>0?d(at):d(it,!1)})}var Be=F(Ne,2);{var nt=d=>{var p=Tr();p.__click=[_r];var k=m(p);k.__click=[mr,T,r];var A=m(k),N=m(A);{var L=S=>{var z=He("✓");E(S,z)};P(N,S=>{u.key===r.activeKey&&u.direction==="asc"&&S(L)})}b(A),je(2),b(k);var D=F(k,2);D.__click=[kr,T,r];var ue=m(D),ye=m(ue);{var Ee=S=>{var z=He("✓");E(S,z)};P(ye,S=>{u.key===r.activeKey&&u.direction==="desc"&&S(Ee)})}b(ue),je(2),b(D);var _e=F(D,4),fe=m(_e);fe.__click=[Sr,r];var Te=F(fe,2);{var R=S=>{var z=Er(),Q=m(z);xe(Q,21,()=>n.getFilterItems(r.activeKey,l(o)),me,(W,re)=>{var se=Or();se.__click=()=>{n.selectFilterItem(l(re),r.activeKey,l(o)),r.close()};var X=m(se),q=m(X);{var pe=ge=>{var ct=He("✓");E(ge,ct)};P(q,ge=>{n.isFilterSelected(r.activeKey,l(re))&&ge(pe)})}b(X);var B=F(X,2),le=m(B,!0);b(B),b(se),j(()=>oe(le,l(re))),E(W,se)},W=>{var re=Cr();E(W,re)}),b(Q),b(z),E(S,z)};P(Te,S=>{r.filterOpen&&S(R)})}b(_e),b(p),j(()=>de(p,`top: ${r.y??""}px; left: ${r.x??""}px;`)),E(d,p)};P(Be,d=>{r.activeKey&&d(nt)})}var lt=F(Be,2);{var ot=d=>{var p=Rr();p.__click=[Ar];var k=m(p);k.__click=[nr,t];var A=F(k,4);A.__click=M;var N=F(A,2);N.__click=I,b(p),j(()=>de(p,`top: ${t.y??""}px; left: ${t.x??""}px;`)),E(d,p)};P(lt,d=>{t.visible&&d(ot)})}Ut(ee,()=>n.inputValue,d=>n.inputValue=d),E(a,w),Vt()}Kt(["keydown","click","mousedown","contextmenu"]);export{Lr as component};
